import { 
    FETCH_PRICE_SUCCESS,
    FETCH_PRICE_START,
    FETCH_PRICE_FAILURE,

    FETCH_COIN_START,
    FETCH_COIN_SUCCESS,
    FETCH_COIN_FAILURE, 
    
    FETCH_NEWS_START,
    FETCH_NEWS_SUCCESS,
    FETCH_NEWS_FAILURE,

    AUTH,
    SIGN_OUT,
 } from "actionsTypes"

import request from 'superagent'
import {fetchNewsApi} from 'api'

export const fetchPrice = () => async dispatch =>{
    dispatch({type:FETCH_PRICE_START})

    try {
        request.get("https://api.coinmarketcap.com/v1/ticker/?limit=72").then(
            res => dispatch({
                type: FETCH_PRICE_SUCCESS, payload: res.body
            })
        )    
    } catch (error) {
        dispatch({
            type:FETCH_PRICE_FAILURE,
            payload:error
        })
    }

}
/* 1 - coin action */ 
export const fetchCoin = (id) => async dispatch => {
    dispatch({type:FETCH_COIN_START})
    try {
        request.get(`https://api.coinmarketcap.com/v1/ticker/${id}/?convert=ETH`).then(
            res => dispatch({
                type: FETCH_COIN_SUCCESS , payload: res.body
            })
        )
    } catch (error) {
        
    }
}



export const fetchNews = () => async dispatch => {
 dispatch({type:FETCH_NEWS_START})
    
 try {
     const news = await fetchNewsApi()
     dispatch({
         type: FETCH_NEWS_SUCCESS,
         payload: news
     })
 } catch (error) {
     dispatch({
         type: FETCH_NEWS_FAILURE,
         payload: error,
         error: true
     })
 }
}

export const auth = (id) =>  dispatch => {
    dispatch({
        type: AUTH,
        hideButton : true,
        UserId : id
    })

}

export const signout = (id) =>  dispatch => {
    dispatch({
        type: SIGN_OUT,
        hideButton : false

    })

}